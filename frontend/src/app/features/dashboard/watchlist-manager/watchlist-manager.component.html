<div hlmCard>
  <div
    hlmCardContent
    class="pt-6"
  >
    <!-- Watchlist Selection and Management -->
    <div class="flex items-center justify-between mb-4">
      <div class="flex items-center space-x-2">
        <div
          class="relative"
          [formGroup]="watchlistForm"
        >
          <brn-select formControlName="selectedWatchlist">
            <hlm-select-trigger class="w-[180px]">
              <hlm-select-value>
                <div class="flex items-center">
                  @if (activeWatchlist(); as watchlist) {
                  <span
                    class="inline-block w-3 h-3 rounded-full mr-2 border border-foreground/20"
                    [ngStyle]="{
                      backgroundColor: watchlist.color,
                      borderColor: 'hsl(0, 0%, 20%)'
                    }"
                  ></span>
                  }
                  {{ getSelectedWatchlistName() }}
                </div>
              </hlm-select-value>
            </hlm-select-trigger>
            <hlm-select-content>
              <div class="max-h-[300px] overflow-auto">
                @for (watchlist of watchlists(); track watchlist.id) {
                <hlm-option
                  [value]="watchlist.id"
                  class="relative flex items-center justify-between rounded-sm py-1.5 pl-2 pr-8 text-sm"
                >
                  <div class="flex items-center">
                    <span
                      class="inline-block w-3 h-3 rounded-full mr-2 border border-foreground/20"
                      [ngStyle]="{
                        backgroundColor: watchlist.color,
                        borderColor: 'hsl(0, 0%, 20%)'
                      }"
                    ></span>
                    {{ watchlist.name }}
                  </div>
                </hlm-option>
                }
              </div>
            </hlm-select-content>
          </brn-select>
        </div>

        <!-- Edit Watchlist Dialog -->
        <app-edit-watchlist-dialog
          [watchlist]="activeWatchlist()"
          [disabled]="!selectedWatchlistId()"
          (watchlistUpdated)="onWatchlistUpdated()"
        ></app-edit-watchlist-dialog>

        <!-- Delete Button with Confirmation Dialog -->
        <app-confirmation-dialog
          triggerText=""
          triggerVariant="outline"
          triggerClass="h-9 w-9 text-destructive hover:text-destructive hover:bg-destructive/10"
          [disabled]="!selectedWatchlistId()"
          title="Delete Watchlist"
          [description]="getDeleteConfirmationMessage()"
          confirmText="Delete"
          confirmVariant="destructive"
          cancelText="Cancel"
          (confirmed)="onDeleteConfirmed()"
        >
          <lucide-angular
            [img]="trashIcon"
            class="w-4 h-4"
          ></lucide-angular>
        </app-confirmation-dialog>
      </div>

      <!-- New Watchlist Dialog -->
      <app-create-watchlist-dialog
        (watchlistCreated)="onWatchlistCreated()"
      ></app-create-watchlist-dialog>
    </div>

    <!-- Add Channel Component -->
    @if (selectedWatchlistId()) {
    <app-add-channel [watchlistId]="selectedWatchlistId()!" />
    }
  </div>
</div>
